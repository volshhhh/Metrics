# ClickTracker & RobotCount — Система детекции «роботов» по частоте кликов

## Описание  
Модуль позволяет регистрировать клики от пользователей в любой момент, отслеживать «подозрительную» активность (пользователей-роботов), сделавших слишком много кликов за короткий интервал, и логировать метрику количества новых забаненных «роботов» в единицу времени. В качестве логгера используется `MetricsWriter` из модуля MetricUtils.

## Компоненты

- **ClickTracker**  
  - Хранит для каждого `userId` очередь временных меток кликов.  
  - Параметры:  
    - `robotInterval` — окно времени (ms) для подсчёта кликов.  
    - `robotClicks` — порог кликов за окно, выше которого пользователь считается «роботом» и банится.  
  - Логика на `registerClick(userId)`:  
    1. Удаляет старые метки за пределами окна.  
    2. Добавляет текущее время.  
    3. Если очередь ≥ `robotClicks` → бан и сброс очереди, инкремент счётчика новых банов.  
  - Методы:  
    - `cntUsers()` — число активных (не забаненных) пользователей.  
    - `cntRobots()` — общее число забаненных «роботов».  
    - `getNewlyBannedRobotsAndReset()` — число новых банов за интервал и сброс счётчика.  

- **RobotCount**  
  Наследует `IMetric`, в `getValueAndReset()` вызывает `getNewlyBannedRobotsAndReset()` у `ClickTracker` и возвращает результат как строку.

- **MetricsWriter**  
  Принимает имя файла и интервал записи. Периодически вызывает у зарегистрированных метрик `getName()` и `getValueAndReset()`, и записывает результаты в лог с timestamp.

- **RobotCountTest**  
  - Создаёт `ClickTracker` и `RobotCount`.  
  - Генерирует `totalClicks` случайных пачек кликов по `numUsers` (пакетная генерация с паузой 40–60 ms).  
  - Запускает `MetricsWriter`, который каждую секунду пишет в `robot_metric_test.log` число новых банов.  
  - По завершении даёт дополнительное время на финальную запись и завершает программу.

## Пример вывода (`robot_metric_test.log`)  
```text
2025-06-16 21:01:41.547 "robots_detected_per_sec" 4
2025-06-16 21:01:42.548 "robots_detected_per_sec" 2
2025-06-16 21:01:43.548 "robots_detected_per_sec" 1
…
```

## Сборка и запуск


1. С корня
   ```bash
  ./build/click/RobotCountLogTest
   ```
2. В корне появится `robot_metric_test.log` с результатами.

## Настройка

- **Порог распознавания «робота»** задаётся в конструкторе:
  ```cpp
  ClickTracker tracker(std::chrono::milliseconds(100), 5);
  ```
- **Интервал логирования** указывается при создании `MetricsWriter`:
  ```cpp
  MetricsWriter writer("robot_metric_test.log", std::chrono::milliseconds(1000));
  ```