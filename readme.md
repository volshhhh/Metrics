# Система сбора и логирования метрик

## Описание

Этот проект реализует многопоточную систему сбора, агрегации и логирования различных метрик для приложений на C++. Система поддерживает пользовательские метрики, такие как производительность процессора, использование памяти и подсчёт количества случайных чисел, делящихся на 3.

---

## Основные компоненты

### 1. Интерфейс метрики (`IMetric`)
Базовый интерфейс для всех метрик:
- `getName()` — возвращает имя метрики.
- `getValueAndReset()` — возвращает значение и сбрасывает состояние.

### 2. Реализации метрик
- **CounterMetric** — считает, сколько случайных чисел, сгенерированных в процессе работы программы, делятся на 3. Для этого используется метод `considerNumber(int value)`, который увеличивает счётчик, если число делится на 3.
- **CpuPerformanceMetric** — измеряет относительную производительность процессора, считая количество математических операций, выполненных за заданный интервал времени.
- **MemoryUsageMetric** — измеряет текущее использование оперативной памяти процессом.

### 3. MetricsWriter
Потокобезопасный логгер, который периодически опрашивает все зарегистрированные метрики и пишет их значения в файл `system_metrics.log`.

---

## Как работает main.cpp

- Создаются и регистрируются метрики: производительность CPU, использование памяти, количество чисел, делящихся на 3.
- Запускается поток, который каждую 0.05 секунды генерирует случайное число и передаёт его в `CounterMetric`.
- Логгер каждую секунду записывает значения всех метрик в файл.
- Программа работает 10 секунд, после чего завершает все потоки.

---

## Пример вывода (system_metrics.log)

```
2025-06-16 12:00:01.123 "cpu_performance_score" 12345 "memory_usage_mb" 42 "divisible_by_3" 7
2025-06-16 12:00:02.124 "cpu_performance_score" 12401 "memory_usage_mb" 43 "divisible_by_3" 6
...
```

---

## Как собрать и запустить

1. **Сборка:**
   ```sh
   cmake -S . -B build
   cmake --build build
   ```

2. **Запуск:**
   ```sh
   ./build/my_app
   ```

3. **Результат:**  
   Метрики будут записываться в файл `system_metrics.log` в корне проекта.

---

## Как добавить новую метрику

1. Реализуйте интерфейс `IMetric` (см. пример в `ExampleMetrics/CounterMetric.h`).
